{% extends 'base.html' %}
{% load static %}

{% block title %}Change Password | P.O Monitoring System{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/change_password.css' %}">
{% endblock %}

{% block content %}

{% include "toast_messages.html" %}

 <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <div class="d-flex align-items-center gap-2">
      {% comment %} <img src="{% static 'img/mlogo.png' %}" alt="Logo" style="height: 32px; width: 32px; object-fit: contain; margin-right: 0.5rem;"> {% endcomment %}
      <h1 class="h3 mb-0">Account Settings</h1>
    </div>
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb breadcrumb-sm mb-0">
      <li class="breadcrumb-item">P.O Monitoring System</li>
      <li class="breadcrumb-item active" aria-current="page">Account</li>
      <li class="breadcrumb-item active" aria-current="page">Change Password</li>
      </ol>
    </nav>
  </div>

  <ul class="nav nav-tabs">
  <li class="nav-item">
    <a class="nav-link" href="{% url 'dashboard' username=request.user.username %}">Dashboard</a>
  </li>
  <li class="nav-item">
    <a class="nav-link active" href="#">Change Password</a>
  </li>
</ul>
</br>

<div class="alert alert-warning mb-0" role="alert">
  You can change your password here. Make sure to remember credentials. Password cannot be resetted by user!
</div>
</br>

  <div class="card p-4">
    <div class="card-body">
        
        <!-- Display non-field errors at the top of the form -->
        {% if form.non_field_errors %}
        <div class="alert alert-danger" role="alert">
            <ul class="mb-0">
            {% for error in form.non_field_errors %}
                <li>{{ error }}</li>
            {% endfor %}
            </ul>
        </div>
        {% endif %}

        <form method="post" novalidate>
            {% csrf_token %}

            <div class="mb-3">
                <label for="{{ form.old_password.id_for_label }}" class="form-label">Current Password</label>
                <input
                    type="password"
                    name="{{ form.old_password.name }}"
                    id="{{ form.old_password.id_for_label }}"
                    class="form-control"
                    placeholder="Enter current password"
                    required
                />
                <!-- Display field-specific errors -->
                {% if form.old_password.errors %}
                <div class="invalid-feedback d-block">
                    <ul class="list-unstyled mb-0">
                    {% for error in form.old_password.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>

            <div class="mb-3">
                <label for="{{ form.new_password1.id_for_label }}" class="form-label">New Password</label>
                <input
                    type="password"
                    name="{{ form.new_password1.name }}"
                    id="{{ form.new_password1.id_for_label }}"
                    class="form-control"
                    placeholder="Enter new password"
                    required
                />
                <!-- Display field-specific errors -->
                {% if form.new_password1.errors %}
                <div class="invalid-feedback d-block">
                    <ul class="list-unstyled mb-0">
                    {% for error in form.new_password1.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>

            <div class="mb-3">
                <label for="{{ form.new_password2.id_for_label }}" class="form-label">Confirm New Password</label>
                <input
                    type="password"
                    name="{{ form.new_password2.name }}"
                    id="{{ form.new_password2.id_for_label }}"
                    class="form-control"
                    placeholder="Confirm new password"
                    required
                />
                <!-- Display field-specific errors -->
                {% if form.new_password2.errors %}
                <div class="invalid-feedback d-block">
                    <ul class="list-unstyled mb-0">
                    {% for error in form.new_password2.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>

            <button type="submit" class="btn btn-primary w-100 py-2 fw-semibold">
            <span data-feather="lock" class="me-2" aria-hidden="true"></span>
                Update Password
            </button>
        </form>
    </div>
</div>

{% include "leave_page.html" %}


{% endblock %}

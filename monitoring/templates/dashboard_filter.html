<style>
/* Filter Section Container */
.filter-section {
    background: #ffffff;
    border-radius: 12px;
    padding: 1.5rem 2rem;
    margin: 1rem auto 0rem auto;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
    border: 1px solid #f0f0f0;
}

/* Optional section header style */
.filter-header {
    font-size: 1rem;
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 1.25rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #f0f0f0;
}

.filter-form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 1rem;
    align-items: start; /* instead of center */
    width: 100%;
}

.grid-item {
    display: flex;
    flex-direction: column;
    justify-content: flex-start; /* always start from top */
}

.grid-item label {
    font-weight: 600; 
    font-size: 0.9rem;
    color: #2c3e50;
    margin-bottom: 0.4rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Input & select base styling */
.filter-form-grid .grid-item input,
.filter-form-grid .grid-item select {
    width: 100%;
    border-radius: 8px;
    padding: 0.6rem 1rem;
    font-size: 0.9rem;
    height: 44px;
    border: 1px solid #dcdcdc;
    background-color: #ffffff;
    transition: all 0.2s ease;
}

/* Focus styling */
.filter-form-grid .grid-item input:focus,
.filter-form-grid .grid-item select:focus {
    outline: none;
    border-color: #0d6efd;
    box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.15);
}

/* Active filter styling (for select & date inputs) */
.filter-section .form-select.active-filter,
.filter-section input[type="date"].active-filter {
    border: 2px solid #0d6efd;
    background-color: #e9f3ff;
    color: #0d6efd;
    font-weight: 600;
}

/* Responsive breakpoints */
@media (max-width: 992px) {
    .filter-form-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 576px) {
    .filter-form-grid {
        grid-template-columns: 1fr;
        gap: 0.75rem;
    }
}

/* New styling for the "None" checkbox and its label */
.none-filter-option {
    display: flex;
    align-items: center; /* Vertically aligns the checkbox and label */
    margin-top: 0.5rem; /* Adds space between the date input and the checkbox */
    gap: 8px; /* Space between the checkbox and the label text */
}

/* Style for the "None" checkbox */
.none-filter-option input[type="checkbox"] {
    width: 16px; /* Explicitly set the width */
    height: 16px; /* Explicitly set the height */
    margin: 0; /* Remove any default margins */
}

/* Style for the "None" label text */
.none-filter-option label {
    font-size: 0.9rem;
    font-weight: 400; /* Regular weight for a less prominent look */
    color: #2c3e50;
    margin: 0; /* Remove any default margins */
    text-transform: none; /* Ensure the text is not uppercase */
    letter-spacing: normal; /* Reset letter spacing */
}

input:disabled {
    cursor: not-allowed; /* shows circle-slash */
    background-color: #f8f9fa; /* light gray so it's clear it's disabled */
    opacity: 0.7; /* make it look inactive */
}

/* Remove extra space caused by margins of last child elements */
.filter-section > *:last-child {
    margin-bottom: 0 !important;
}

/* Also target form elements inside (like your filter-form-grid) */
.filter-section > *:last-child > *:last-child {
    margin-bottom: 0 !important;
}


</style>

<div class="filter-section">
  <form method="get" class="filter-form-grid">

    <div class="grid-item">
      <label for="search-input"><span class="icon">&#128269;</span> Search P.O:</label>
      <input type="text" 
             name="search" 
             id="search-input"
             class="form-control" 
             placeholder="Enter P.O..." 
             autocomplete="off" 
             value="{{ search_query }}"
             data-list="purchase-orders-list"> 
      <datalist id="purchase-orders-list">
        {% for po_number in po_numbers_list %}
            <option value="{{ po_number }}">
        {% endfor %}
      </datalist>
    </div>

    <div class="grid-item">
      <label for="customer">Filter Customer</label>
      <select name="customer" id="customer"
              class="form-select {% if selected_customer %}active-filter{% endif %}" 
              onchange="this.form.submit()">
        <option value="">All Customers</option>
        {% for name in customer_list %}
          <option value="{{ name }}" {% if selected_customer == name %}selected{% endif %}>{{ name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="grid-item">
        <label for="date_started">Filter Started Date</label>
        <input type="date" 
              name="date_started" 
              id="date_started"
              class="form-control {% if selected_started %}active-filter{% endif %}"
              value="{{ selected_started|default:'' }}"
              onchange="this.form.submit()">
        
        <div class="none-filter-option">
            <input type="checkbox"
                  name="date_none"
                  id="date_none"
                  value="1"
                  {% if date_none %}checked{% endif %}
                  onchange="this.form.submit()">
            <label for="date_none">Filter by None</label>
        </div>
    </div>


    <div class="grid-item">
      <label for="target_date">Filter Target Date</label>
      <input type="date" 
            name="target_date" 
            id="target_date"
            class="form-control {% if selected_target %}active-filter{% endif %}"
            value="{{ selected_target|default:'' }}"
            onchange="this.form.submit()">
    </div>

    <div class="grid-item">
      <label for="status">Filter Status</label>
      <select name="status" id="status"
              class="form-select {% if selected_status %}active-filter{% endif %}" 
              onchange="this.form.submit()">
        <option value="">All Statuses</option>
        <option value="Pending" {% if selected_status == 'Pending' %}selected{% endif %}>Pending</option>
        <option value="Ongoing" {% if selected_status == 'Ongoing' %}selected{% endif %}>Ongoing</option>
        <option value="Completed" {% if selected_status == 'Completed' %}selected{% endif %}>Completed</option>
        <option value="Delayed" {% if selected_status == 'Delayed' %}selected{% endif %}>Delayed</option>
        <option value="Cancelled" {% if selected_status == 'Cancelled' %}selected{% endif %}>Cancelled</option>
      </select>
    </div>

  </form>
</div>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.getElementById('search-input');
        const datalistId = searchInput.getAttribute('data-list');

        // Initially, the list attribute is not set
        // so no suggestions will show on focus.

        searchInput.addEventListener('input', function() {
            // Check if the input field has any text
            if (this.value.length > 0) {
                // If there's text, add the list attribute
                this.setAttribute('list', datalistId);
            } else {
                // If the input is empty, remove the list attribute
                this.removeAttribute('list');
            }
        });
    });
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const datePicker = document.getElementById('date_started');
    const noneCheckbox = document.getElementById('date_none');

    function toggleFields() {
        // Disable the checkbox if date has a value
        noneCheckbox.disabled = datePicker.value !== '';

        // Disable the datepicker if checkbox is checked
        datePicker.disabled = noneCheckbox.checked;
    }

    // Initial check when the page loads
    toggleFields();

    // Listen for changes
    datePicker.addEventListener('input', toggleFields);
    noneCheckbox.addEventListener('change', toggleFields);
});
</script>
